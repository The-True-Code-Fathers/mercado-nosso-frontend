<header class="header">
  <!-- Top Bar -->
  <div class="header-top">
    <div class="header-top-container">
      <div class="top-left">
        <span class="delivery-info">
          <i class="pi pi-map-marker"></i>
          Entregamos para toda São Paulo
        </span>
      </div>
      <div class="top-right">
        <span class="welcome-text">Bem-vindo ao Mercado Nosso!</span>
      </div>
    </div>
  </div>

  <!-- Main Header -->
  <div class="header-main">
    <div class="header-container">
      <!-- Logo/Brand -->
      <div class="brand" routerLink="/home">
        <i class="pi pi-shopping-bag brand-icon"></i>
        <span class="brand-text">Mercado Nosso</span>
      </div>

      <!-- Desktop Navigation -->
      <div class="desktop-nav">
        <!-- Search Bar - More prominent -->
        <div class="search-container">
          <div class="search-wrapper">
            <p-iconField iconPosition="left" class="search-field">
              <p-inputIcon styleClass="pi pi-search"></p-inputIcon>
              <input
                type="text"
                pInputText
                placeholder="O que você está procurando?"
                [(ngModel)]="searchTerm"
                (keyup.enter)="onSearch()"
                class="search-input"
              />
            </p-iconField>
            <p-button
              icon="pi pi-search"
              styleClass="p-button-success search-button"
              (click)="onSearch()"
              pTooltip="Buscar">
            </p-button>
          </div>

          <!-- Quick Categories -->
          <div class="quick-categories">
            <span class="category-link" *ngFor="let category of quickCategories"
                  [routerLink]="['/products']" [queryParams]="{category: category.key}">
              {{ category.label }}
            </span>
          </div>
        </div>
      </div>

      <!-- User Actions -->
      <div class="user-actions desktop-only">
        <!-- Categories Button -->
        <div class="categories-container">
          <p-button
            label="Categorias"
            icon="pi pi-th-large"
            styleClass="p-button-outlined categories-button"
            (click)="toggleCategoriesMenu($event)"
            [attr.aria-expanded]="categoriesMenuVisible"
            [attr.aria-haspopup]="true">
          </p-button>
          <p-overlayPanel #categoriesPanel>
            <div class="categories-menu">
              <div class="category-item" *ngFor="let category of categories">
                <a [routerLink]="['/products']" [queryParams]="{category: category.key}">
                  <i [class]="category.icon"></i>
                  <span>{{ category.label }}</span>
                </a>
              </div>
            </div>
          </p-overlayPanel>
        </div>

        <div class="action-separator"></div>

        <p-button
          icon="pi pi-shopping-cart"
          styleClass="p-button-text p-button-rounded cart-action"
          pTooltip="Meu Carrinho"
          routerLink="/cart">
          <p-badge value="3" severity="danger" class="cart-badge"></p-badge>
        </p-button>

        <p-button
          icon="pi pi-user"
          styleClass="p-button-text p-button-rounded user-action"
          pTooltip="Minha Conta"
          routerLink="/user">
        </p-button>

        <p-button
          [icon]="isDarkMode ? 'pi pi-sun' : 'pi pi-moon'"
          styleClass="p-button-text p-button-rounded theme-action"
          [pTooltip]="isDarkMode ? 'Modo Claro' : 'Modo Escuro'"
          (click)="toggleTheme()">
        </p-button>
      </div>
    </div>
  </div>

  <!-- Mobile Menu Button -->
  <div class="mobile-menu-button">
    <p-button
      icon="pi pi-bars"
      styleClass="p-button-text p-button-rounded"
      (click)="toggleMobileMenu()"
      [attr.aria-expanded]="mobileMenuVisible">
    </p-button>
  </div>

  <!-- Mobile Menu -->
  <div class="mobile-menu" [class.mobile-menu-active]="mobileMenuVisible">
    <div class="mobile-search">
      <div class="mobile-search-wrapper">
        <p-iconField iconPosition="left" class="mobile-search-field">
          <p-inputIcon styleClass="pi pi-search"></p-inputIcon>
          <input
            type="text"
            pInputText
            placeholder="O que você está procurando?"
            [(ngModel)]="searchTerm"
            (keyup.enter)="onSearch()"
            class="search-input"
          />
        </p-iconField>
        <p-button
          icon="pi pi-search"
          styleClass="p-button-success mobile-search-button"
          (click)="onSearch()">
        </p-button>
      </div>
    </div>

    <div class="mobile-categories">
      <p-button
        label="Todas as Categorias"
        icon="pi pi-angle-down"
        styleClass="p-button-outlined mobile-categories-button"
        (click)="toggleMobileCategoriesMenu()"
        [attr.aria-expanded]="mobileCategoriesVisible">
      </p-button>

      <div class="mobile-categories-menu" [class.mobile-categories-active]="mobileCategoriesVisible">
        <div class="category-item" *ngFor="let category of categories">
          <a [routerLink]="['/products']" [queryParams]="{category: category.key}" (click)="closeMobileMenu()">
            <i [class]="category.icon"></i>
            <span>{{ category.label }}</span>
          </a>
        </div>
      </div>
    </div>

    <div class="mobile-actions">
      <div class="mobile-action-item">
        <p-button
          icon="pi pi-shopping-cart"
          label="Meu Carrinho"
          styleClass="p-button-outlined mobile-action-button"
          routerLink="/cart"
          (click)="closeMobileMenu()">
          <p-badge value="3" severity="danger" class="cart-badge"></p-badge>
        </p-button>
      </div>

      <div class="mobile-action-item">
        <p-button
          icon="pi pi-user"
          label="Minha Conta"
          styleClass="p-button-outlined mobile-action-button"
          routerLink="/user"
          (click)="closeMobileMenu()">
        </p-button>
      </div>

      <div class="mobile-action-item">
        <p-button
          [icon]="isDarkMode ? 'pi pi-sun' : 'pi pi-moon'"
          [label]="isDarkMode ? 'Modo Claro' : 'Modo Escuro'"
          styleClass="p-button-outlined mobile-action-button"
          (click)="toggleTheme(); closeMobileMenu()">
        </p-button>
      </div>
    </div>
  </div>
</header>
