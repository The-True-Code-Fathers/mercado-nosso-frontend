<!-- Checkout Steps Navigation -->
<app-checkout-steps [steps]="steps()"></app-checkout-steps>

<div class="checkout-container">
  <div class="checkout-content">
    <div class="checkout-main">
      <!-- Step 0: Cart Review -->
      <div *ngIf="currentStep() === 0" class="step-container">
        <div class="cart-review-step">
          <div class="step-header">
            <h2>Revisar itens</h2>
            <p>Confirme os produtos antes de continuar</p>
          </div>

          <div class="cart-items" *ngIf="orderSummary()">
            <div class="items-list">
              <div
                *ngFor="let item of orderSummary()!.items"
                class="cart-item-review"
              >
                <div class="item-image">
                  <img [src]="item.image" [alt]="item.name" />
                </div>
                <div class="item-details">
                  <h4>{{ item.name }}</h4>
                  <p class="item-price">
                    {{ item.quantity }}x R$
                    {{ item.unitPrice | number : '1.2-2' }}
                  </p>
                </div>
                <div class="item-total">
                  <span>R$ {{ item.totalPrice | number : '1.2-2' }}</span>
                </div>
              </div>
            </div>
          </div>

          <div class="step-actions">
            <button type="button" class="btn-back" (click)="goToCart()">
              <i class="pi pi-arrow-left"></i>
              Voltar ao Carrinho
            </button>

            <button
              type="button"
              class="btn-continue"
              (click)="continueToShipping()"
            >
              Continuar para Entrega
              <i class="pi pi-arrow-right"></i>
            </button>
          </div>
        </div>
      </div>

      <!-- Step 1: Shipping -->
      <app-shipping-step *ngIf="currentStep() === 1"></app-shipping-step>

      <!-- Step 2: Payment -->
      <app-payment-step *ngIf="currentStep() === 2"></app-payment-step>

      <!-- Step 3: Confirmation -->
      <app-confirmation-step *ngIf="currentStep() === 3"></app-confirmation-step>

      <!-- Loading State -->
      <div *ngIf="isLoading()" class="loading-state">
        <div class="loading-content">
          <i class="pi pi-spin pi-spinner loading-icon"></i>
          <h3>Processando...</h3>
          <p>Preparando seu checkout</p>
        </div>
      </div>
    </div>

    <!-- Order Summary Sidebar -->
    <div class="checkout-sidebar">
      <app-order-summary [orderSummary]="orderSummary()"></app-order-summary>
    </div>
  </div>
</div>

<p-toast></p-toast>
